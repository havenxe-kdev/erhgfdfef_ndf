<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment SBP</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }

        /* –ö–Ω–æ–ø–∫–∞ HOME –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É */
        .home-button {
            background: #eef2f6;
            padding: 8px 20px;
            border-radius: 20px;
            color: #4a5f7e;
            font-size: 15px;
            font-weight: 600;
            border: 1px solid #d0ddee;
            cursor: pointer;
            transition: 0.1s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
        }
        .home-button:hover {
            background: #e0e6f2;
            border-color: #9aafcc;
            color: #1f3a5e;
        }

        /* –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ */
        .card-panel {
            width: 100%;
            max-width: 520px;
            background: white;
            border-radius: 8px;
            padding: 28px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.08), 0 3px 10px rgba(0,0,0,0.03);
            border: 1px solid #e7ecf3;
        }

        /* –≠–ö–†–ê–ù –í–í–û–î–ê */
        #inputScreen h2 {
            font-size: 26px;
            font-weight: 600;
            color: #14273e;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        #inputScreen h2 span {
            background: #eaf1fb;
            padding: 4px 14px;
            border-radius: 20px;
            font-size: 14px;
            color: #1f4a9c;
            border: 1px solid #c4d4e8;
            font-weight: 500;
        }
        .label-row {
            display: flex;
            justify-content: space-between;
            color: #475e7c;
            font-size: 15px;
            margin-top: 20px;
            margin-bottom: 6px;
            font-weight: 500;
        }
        .input-field {
            width: 100%;
            background: #f9fbfe;
            border: 1.5px solid #dbe2ec;
            border-radius: 8px;
            padding: 16px 20px;
            font-size: 16px;
            color: #121826;
            outline: none;
            transition: 0.15s;
        }
        .input-field:focus {
            border-color: #2869e8;
            background: white;
            box-shadow: 0 0 0 4px rgba(40,105,232,0.08);
        }

        /* –ö–Ω–æ–ø–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π */
        .toggle-settings {
            background: #eef2f6;
            border: 1px solid #d0ddee;
            border-radius: 20px;
            padding: 12px 20px;
            font-size: 15px;
            font-weight: 600;
            color: #1f3a5e;
            cursor: pointer;
            margin: 20px 0 10px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: 0.1s;
        }
        .toggle-settings:hover {
            background: #e0e6f2;
        }
        .toggle-settings .arrow {
            font-size: 18px;
            transition: transform 0.2s;
        }
        .toggle-settings.open .arrow {
            transform: rotate(180deg);
        }

        /* –ë–ª–æ–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
        .settings-panel {
            display: none;
            background: #f7fafd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 10px;
            border: 1px solid #dbe2ec;
        }
        .settings-panel.show {
            display: block;
        }

        .confirm-btn {
            background: #1a3f74;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 18px 28px;
            font-size: 18px;
            font-weight: 600;
            width: 100%;
            margin: 32px 0 12px 0;
            cursor: pointer;
            transition: 0.15s;
            box-shadow: 0 8px 18px rgba(26,63,116,0.15);
            border: 1px solid #254f8a;
        }
        .confirm-btn:hover {
            background: #235198;
        }

        /* –≠–ö–†–ê–ù –ü–õ–ê–¢–ï–ñ–ê */
        .payment-screen {
            display: none;
        }

        .timer-container {
            background: #eef2f6;
            border-radius: 20px;
            padding: 8px 16px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #d0ddee;
            max-width: 480px;
        }
        .timer-label {
            font-size: 14px;
            font-weight: 500;
            color: #1f3a60;
        }
        .timer-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 24px;
            font-weight: 700;
            color: #14467e;
            letter-spacing: 2px;
        }

        .payment-name {
            font-size: 18px;
            font-weight: 500;
            color: #2f4a73;
            background: #edf4fd;
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 20px;
            border: 1px solid #c9daf2;
            word-break: break-word;
        }

        .large-amount {
            font-size: 52px;
            font-weight: 700;
            color: #0c1e3f;
            letter-spacing: -1px;
            line-height: 1.1;
            margin-bottom: 28px;
            border-bottom: 1px solid #e2e9f2;
            padding-bottom: 20px;
        }

        .detail-row {
            display: flex;
            align-items: baseline;
            padding: 12px 0;
            border-bottom: 1px solid #edf2f8;
        }
        .detail-label {
            width: 130px;
            color: #5d718d;
            font-size: 15px;
            font-weight: 500;
        }
        .detail-value {
            flex: 1;
            color: #121f35;
            font-size: 16px;
            font-weight: 500;
            word-break: break-word;
            text-align: left;
        }
        .detail-value.mono {
            font-family: 'JetBrains Mono', monospace;
            font-size: 17px;
            letter-spacing: 0.2px;
        }

        .copy-row {
            display: flex;
            justify-content: flex-end;
            margin-top: 6px;
            margin-bottom: 10px;
        }
        .copy-btn {
            background: #eef2f6;
            border: 1px solid #bcc9dc;
            border-radius: 20px;
            padding: 8px 20px;
            font-size: 13px;
            font-weight: 600;
            color: #3a4f6e;
            cursor: pointer;
            transition: 0.1s;
            text-transform: uppercase;
            letter-spacing: 0.4px;
        }
        .copy-btn:hover {
            background: #e0e6f0;
            border-color: #9aafcc;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin: 20px 0;
        }
        .pay-button {
            background: #1a5f3e;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 16px 0;
            font-size: 18px;
            font-weight: 600;
            flex: 1;
            cursor: pointer;
            transition: 0.15s;
            border: 1px solid #0f4a2f;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .pay-button:hover {
            background: #218c4e;
        }
        .cancel-button {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 16px 0;
            font-size: 18px;
            font-weight: 600;
            flex: 1;
            cursor: pointer;
            transition: 0.15s;
            border: 1px solid #b11f2e;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .cancel-button:hover {
            background: #c82333;
        }

        .footnote {
            color: #6f89aa;
            font-size: 14px;
            line-height: 1.5;
            margin-top: 20px;
            background: #f7fafd;
            padding: 16px;
            border-radius: 6px;
            border: 1px solid #e1eaf3;
        }

        .id-row {
            background: #f4f8fe;
            padding: 14px 16px;
            border-radius: 6px;
            margin: 16px 0 8px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 15px;
            color: #1d3d6b;
            border: 1px solid #d2e0f0;
            word-break: break-all;
        }
        .id-label {
            font-size: 13px;
            color: #547197;
            margin-bottom: 4px;
            text-transform: uppercase;
            font-weight: 500;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—à–∏–±–∫–∏ */
        .custom-modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            visibility: hidden;
            opacity: 0;
            transition: 0.15s;
        }
        .custom-modal.show {
            visibility: visible;
            opacity: 1;
        }
        .custom-modal .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 340px;
            width: 90%;
            padding: 28px 22px;
            text-align: center;
            box-shadow: 0 30px 50px rgba(0,0,0,0.3);
            border: 1px solid #dee2e9;
        }
        .custom-modal .big-icon {
            font-size: 64px;
            line-height: 1;
            margin-bottom: 12px;
            color: #b02a37;
        }
        .custom-modal h3 {
            font-size: 24px;
            font-weight: 600;
            color: #1f2a3f;
            margin-bottom: 10px;
        }
        .custom-modal p {
            font-size: 16px;
            color: #435574;
            margin-bottom: 24px;
            white-space: pre-line;
        }
        .custom-modal .modal-btn {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 14px 30px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            border: 1px solid #b11f2e;
        }
        .custom-modal .modal-btn:hover {
            background: #c12a3a;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É—Å–ø–µ—Ö–∞ (—Å –≥–∞–ª–æ—á–∫–æ–π) */
        .success-modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            visibility: hidden;
            opacity: 0;
            transition: 0.15s;
        }
        .success-modal.show {
            visibility: visible;
            opacity: 1;
        }
        .success-modal .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 340px;
            width: 90%;
            padding: 28px 22px;
            text-align: center;
            box-shadow: 0 30px 50px rgba(0,0,0,0.3);
            border: 1px solid #dee2e9;
        }
        .success-modal .big-icon {
            font-size: 64px;
            line-height: 1;
            margin-bottom: 12px;
            color: #1a5f3e;
        }
        .success-modal h3 {
            font-size: 24px;
            font-weight: 600;
            color: #1f2a3f;
            margin-bottom: 10px;
        }
        .success-modal p {
            font-size: 16px;
            color: #435574;
            margin-bottom: 24px;
        }
        .success-modal .modal-btn {
            background: #1a5f3e;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 14px 30px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            border: 1px solid #0f4a2f;
        }
        .success-modal .modal-btn:hover {
            background: #218c4e;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ */
        .timeout-modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 999;
            visibility: hidden;
            opacity: 0;
            transition: 0.15s;
        }
        .timeout-modal.show {
            visibility: visible;
            opacity: 1;
        }
        .timeout-modal .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 340px;
            width: 90%;
            padding: 28px 22px;
            text-align: center;
            box-shadow: 0 30px 50px rgba(0,0,0,0.3);
            border: 1px solid #dee2e9;
        }

        /* –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ */
        .repeat-screen {
            display: none;
            width: 100%;
            max-width: 520px;
        }
        .repeat-card {
            background: white;
            border-radius: 8px;
            padding: 28px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.08), 0 3px 10px rgba(0,0,0,0.03);
            border: 1px solid #e7ecf3;
        }
        .repeat-title {
            font-size: 24px;
            font-weight: 600;
            color: #b02a37;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .repeat-amount {
            font-size: 48px;
            font-weight: 700;
            color: #0c1e3f;
            margin: 20px 0;
        }
        .repeat-warning {
            background: #fff3cd;
            border-left: 6px solid #ffc107;
            padding: 16px;
            border-radius: 6px;
            margin: 20px 0;
            color: #856404;
        }
        .repeat-comment {
            background: #f7fafd;
            padding: 16px;
            border-radius: 6px;
            margin: 20px 0;
            border: 1px solid #dbe2ec;
            font-style: italic;
        }
        .repeat-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }
        .repeat-pay-btn {
            background: #1a5f3e;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 16px 0;
            font-size: 18px;
            font-weight: 600;
            flex: 1;
            cursor: pointer;
        }
        .repeat-cancel-btn {
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 16px 0;
            font-size: 18px;
            font-weight: 600;
            flex: 1;
            cursor: pointer;
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            flex-direction: column;
        }
        .loading-overlay.show {
            display: flex;
        }
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #1a3f74;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .loading-text {
            color: #1a3f74;
            font-size: 18px;
            font-weight: 600;
        }
        
        /* Payment ID display */
        .payment-id-info {
            margin-top: 10px;
            padding: 10px;
            background: #eef2f6;
            border-radius: 4px;
            font-size: 12px;
            color: #666;
            text-align: center;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <!-- –ö–Ω–æ–ø–∫–∞ HOME -->
    <div class="home-button" id="homeButton">HOME</div>

    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <div class="loading-text">–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ -->
    <div class="timeout-modal" id="timeoutModal">
        <div class="modal-content">
            <div class="big-icon">‚úï</div>
            <h3>–û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞</h3>
            <p>–í—Ä–µ–º—è –∏—Å—Ç–µ–∫–ª–æ. –ü–ª–∞—Ç—ë–∂ –Ω–µ –±—ã–ª –∑–∞–≤–µ—Ä—à—ë–Ω.</p>
            <button class="modal-btn" id="closeTimeoutBtn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –¥–ª—è –æ—à–∏–±–∫–∏ -->
    <div class="custom-modal" id="customErrorModal">
        <div class="modal-content">
            <div class="big-icon">‚úï</div>
            <h3 id="errorModalTitle">–û—à–∏–±–∫–∞</h3>
            <p id="errorModalMessage">–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞</p>
            <button class="modal-btn" id="errorModalBtn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –¥–ª—è —É—Å–ø–µ—Ö–∞ -->
    <div class="success-modal" id="successModal">
        <div class="modal-content">
            <div class="big-icon">‚úì</div>
            <h3>–£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞</h3>
            <p>–ü–ª–∞—Ç—ë–∂ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ</p>
            <button class="modal-btn" id="successModalBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div id="appContainer">
        <!-- –≠–ö–†–ê–ù –í–í–û–î–ê -->
        <div class="card-panel" id="inputScreen">
            <h2>üí≥ FAKE_PAY@ton_ultra <span>PRIVATE CODE</span></h2>
            <div style="color:#4f658d; margin-bottom: 20px;">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–ª–∞—Ç–µ–∂–∞</div>

            <div class="label-row">
                <span>–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã</span>
                <span style="color:#6e85aa;">16 —Ü–∏—Ñ—Ä</span>
            </div>
            <input type="text" class="input-field" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" inputmode="numeric">

            <div class="label-row" style="margin-top: 18px;">
                <span>–î–µ—Ä–∂–∞—Ç–µ–ª—å</span>
                <span style="color:#6e85aa;">–∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—è</span>
            </div>
            <input type="text" class="input-field" id="cardHolder" placeholder="Vasya Pupkin">

            <div class="label-row" style="margin-top: 18px;">–ë–∞–Ω–∫</div>
            <input type="text" class="input-field" id="bankName" placeholder="–¢-–ë–∞–Ω–∫, –°–±–µ—Ä, –ê–ª—å—Ñ–∞, OZON">

            <div class="label-row" style="margin-top: 18px;">–°—É–º–º–∞</div>
            <input type="text" class="input-field" id="amount" placeholder="1 000 ‚ÇΩ" value="1 000 ‚ÇΩ">

            <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π -->
            <div class="toggle-settings" id="toggleSettings">
                <span>‚öôÔ∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</span>
                <span class="arrow">‚ñº</span>
            </div>

            <!-- –ë–ª–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
            <div class="settings-panel" id="settingsPanel">
                <div class="label-row">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞</div>
                <input type="text" class="input-field" id="paymentName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–µ—Ä–µ–≤–æ–¥ –¥—Ä—É–≥—É" value="–û–ø–ª–∞—Ç–∞">

                <div class="label-row" style="margin-top: 18px;">–í—Ä–µ–º—è —Ç–∞–π–º–µ—Ä–∞ (–º–∏–Ω—É—Ç—ã)</div>
                <input type="number" class="input-field" id="timerMinutes" placeholder="7" value="7" min="1" max="60">

                <div class="label-row" style="margin-top: 18px;">–¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏</div>
                <input type="text" class="input-field" id="errorMessageText" placeholder="–¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏" value="–í–∑—è—Ç—å –∏–∑ pay_fake_err.txt">

                <div class="label-row" style="margin-top: 18px;">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ—à–∏–±–∫–∏</div>
                <input type="text" class="input-field" id="errorTitleText" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫" value="–û—à–∏–±–∫–∞ –æ–ø–ª–∞—Ç—ã">

                <!-- –ù–æ–≤–æ–µ –ø–æ–ª–µ: –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ -->
                <div class="label-row" style="margin-top: 18px;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞)</div>
                <input type="text" class="input-field" id="repeatCommentText" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" value="–¢–º1 –æ–∑–Ω–∞–∫–æ–º—Ç–µ—Å—å —Å pay_fake_err.txt">
            </div>

            <button class="confirm-btn" id="confirmBtn">‚úì CONFIRM AND GENERATE</button>
            
            <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è ID –ø–ª–∞—Ç–µ–∂–∞ -->
            <div id="paymentIdDisplay" class="payment-id-info"></div>
        </div>

        <!-- –≠–ö–†–ê–ù –ü–õ–ê–¢–ï–ñ–ê -->
        <div class="card-panel payment-screen" id="paymentScreen">
            <div class="timer-container">
                <span class="timer-label">–û—Å—Ç–∞–ª–æ—Å—å</span>
                <span class="timer-value" id="timerDisplay">12:00</span>
            </div>

            <div class="payment-name" id="displayPaymentName">–û–ø–ª–∞—Ç–∞</div>
            
            <div class="large-amount" id="displayAmount">1 000 ‚ÇΩ</div>

            <div class="detail-row">
                <span class="detail-label">–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã</span>
                <span class="detail-value mono" id="displayCard">1234 5678 9012 3456</span>
            </div>
            <div class="copy-row">
                <button class="copy-btn" id="copyCardBtn">COPY</button>
            </div>

            <div class="detail-row">
                <span class="detail-label">–ë–∞–Ω–∫</span>
                <span class="detail-value" id="displayBank">–ë–ê–ù–ö</span>
            </div>

            <div class="detail-row">
                <span class="detail-label">–í–ª–∞–¥–µ–ª–µ—Ü</span>
                <span class="detail-value" id="displayHolder">–í–∞—Å—è –ü—É–ø–∫–∏–Ω</span>
            </div>

            <div class="id-row">
                <div class="id-label">–ù–æ–º–µ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</div>
                <span id="transactionId">23e74999280b40549550a614b594acb1</span>
            </div>

            <div class="action-buttons">
                <button class="pay-button" id="payConfirmedBtn">–Ø –æ–ø–ª–∞—Ç–∏–ª</button>
                <button class="cancel-button" id="cancelPaymentBtn">–û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>

            <div class="footnote">
                –£–∫–∞–∑–∞–Ω–Ω—É—é —Å—É–º–º—É <span id="footnoteAmount">67 ‚ÇΩ</span> –ø–µ—Ä–µ–≤–µ–¥–∏—Ç–µ —Ç–æ—á–Ω–æ –Ω–∞ –∫–∞—Ä—Ç—É –±–∞–Ω–∫–∞ <span id="footnoteBank">–ë–ê–ù–ö</span>.
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù –ü–û–í–¢–û–†–ù–û–ì–û –ü–õ–ê–¢–ï–ñ–ê -->
        <div class="repeat-screen" id="repeatScreen">
            <div class="repeat-card">
                <div class="repeat-title">
                    <span>‚ö†Ô∏è</span> –í–Ω–∏–º–∞–Ω–∏–µ!
                </div>
                
                <div class="repeat-amount" id="repeatAmount">1 000 ‚ÇΩ</div>

                <div class="repeat-warning">
                    <strong>–ë—É–¥—å—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã!</strong> –≠—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –ø–ª–∞—Ç—ë–∂.
                </div>

                <div class="repeat-comment" id="repeatComment">
                    –û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: "–¢–º1 –æ–∑–Ω–∞–∫–æ–º—Ç–µ—Å—å —Å pay_fake_err.txt", –µ—Å–ª–∏ –≤—ã –Ω–µ –æ—Å—Ç–∞–≤–∏—Ç–µ –µ–≥–æ, –ø–ª–∞—Ç–µ–∂ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤–æ–≤—Å–µ.
                </div>

                <div class="repeat-buttons">
                    <button class="repeat-pay-btn" id="repeatPayBtn">–û–ø–ª–∞—Ç–∏—Ç—å</button>
                    <button class="repeat-cancel-btn" id="repeatCancelBtn">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        (function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
            const tg = window.Telegram ? Telegram.WebApp : null;
            if (tg) {
                tg.expand(); // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
                tg.ready(); // –°–æ–æ–±—â–∞–µ–º, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ
                console.log('Telegram WebApp initialized');
            }

            // –≠–∫—Ä–∞–Ω—ã
            const inputScreen = document.getElementById('inputScreen');
            const paymentScreen = document.getElementById('paymentScreen');
            const repeatScreen = document.getElementById('repeatScreen');
            const timeoutModal = document.getElementById('timeoutModal');
            const closeTimeoutBtn = document.getElementById('closeTimeoutBtn');
            const homeButton = document.getElementById('homeButton');
            const loadingOverlay = document.getElementById('loadingOverlay');

            // –ú–æ–¥–∞–ª–∫–∏
            const customModal = document.getElementById('customErrorModal');
            const errorModalBtn = document.getElementById('errorModalBtn');
            const errorModalTitle = document.getElementById('errorModalTitle');
            const errorModalMessage = document.getElementById('errorModalMessage');
            
            const successModal = document.getElementById('successModal');
            const successModalBtn = document.getElementById('successModalBtn');

            // –≠–ª–µ–º–µ–Ω—Ç—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
            const repeatAmount = document.getElementById('repeatAmount');
            const repeatComment = document.getElementById('repeatComment');
            const repeatPayBtn = document.getElementById('repeatPayBtn');
            const repeatCancelBtn = document.getElementById('repeatCancelBtn');

            // –ü–æ–ª—è –≤–≤–æ–¥–∞
            const cardNumberInput = document.getElementById('cardNumber');
            const cardHolderInput = document.getElementById('cardHolder');
            const bankNameInput = document.getElementById('bankName');
            const amountInput = document.getElementById('amount');
            const paymentNameInput = document.getElementById('paymentName');
            const timerMinutesInput = document.getElementById('timerMinutes');
            const errorMessageInput = document.getElementById('errorMessageText');
            const errorTitleInput = document.getElementById('errorTitleText');
            const repeatCommentInput = document.getElementById('repeatCommentText');
            const paymentIdDisplay = document.getElementById('paymentIdDisplay');

            // –ö–Ω–æ–ø–∫–∏
            const confirmBtn = document.getElementById('confirmBtn');
            const payConfirmedBtn = document.getElementById('payConfirmedBtn');
            const cancelPaymentBtn = document.getElementById('cancelPaymentBtn');
            const copyCardBtn = document.getElementById('copyCardBtn');
            const toggleSettings = document.getElementById('toggleSettings');
            const settingsPanel = document.getElementById('settingsPanel');

            // –≠–ª–µ–º–µ–Ω—Ç—ã –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
            const displayPaymentName = document.getElementById('displayPaymentName');
            const displayAmount = document.getElementById('displayAmount');
            const displayCard = document.getElementById('displayCard');
            const displayBank = document.getElementById('displayBank');
            const displayHolder = document.getElementById('displayHolder');
            const transactionSpan = document.getElementById('transactionId');
            const footnoteAmount = document.getElementById('footnoteAmount');
            const footnoteBank = document.getElementById('footnoteBank');
            const timerDisplay = document.getElementById('timerDisplay');

            // –ü–æ–ª—É—á–∞–µ–º payment_id –∏–∑ URL
            const urlParams = new URLSearchParams(window.location.search);
            const paymentId = urlParams.get('payment_id');
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º payment_id –µ—Å–ª–∏ –µ—Å—Ç—å
            if (paymentId) {
                paymentIdDisplay.textContent = 'ID –ø–ª–∞—Ç–µ–∂–∞: ' + paymentId;
            }

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
            let lastPaymentData = {
                amount: 0,
                amountText: '',
                card: '',
                bank: '',
                holder: '',
                errorText: '',
                paymentName: '',
                repeatComment: ''
            };

            // –¢–∞–π–º–µ—Ä
            let timerInterval = null;
            let timeLeftSeconds = 720;
            let timerActive = false;

            function formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }

            function updateTimerDisplay() {
                timerDisplay.textContent = formatTime(timeLeftSeconds);
            }

            function stopTimer() {
                if (timerInterval) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                }
                timerActive = false;
            }

            function startTimer() {
                stopTimer();
                updateTimerDisplay();
                timerActive = true;

                timerInterval = setInterval(() => {
                    if (timeLeftSeconds <= 1) {
                        timeLeftSeconds = 0;
                        updateTimerDisplay();
                        stopTimer();
                        showTimeoutModal();
                    } else {
                        timeLeftSeconds--;
                        updateTimerDisplay();
                    }
                }, 1000);
            }

            function generateRandomId() {
                const chars = '0123456789abcdef';
                let result = '';
                for (let i = 0; i < 32; i++) {
                    result += chars[Math.floor(Math.random() * 16)];
                }
                return result;
            }

            // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –æ–ø–ª–∞—Ç—ã
            function switchToPaymentScreen() {
                let rawCard = cardNumberInput.value.trim();
                if (rawCard === '') rawCard = '**** **** **** ****';
                let digitsOnly = rawCard.replace(/\s+/g, '');
                let formattedCard = '';
                for (let i = 0; i < digitsOnly.length; i++) {
                    if (i > 0 && i % 4 === 0) formattedCard += ' ';
                    formattedCard += digitsOnly[i];
                }
                if (formattedCard === '') formattedCard = rawCard;

                const holder = cardHolderInput.value.trim() || '–ù–µ —É–∫–∞–∑–∞–Ω';
                const bank = bankNameInput.value.trim() || '–ù–µ —É–∫–∞–∑–∞–Ω';
                let amountValue = amountInput.value.trim();
                if (amountValue === '') amountValue = '‚Äî';
                
                let paymentName = paymentNameInput.value.trim();
                if (paymentName === '') paymentName = '–ü–µ—Ä–µ–≤–æ–¥';

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
                let numericAmount = parseFloat(amountValue.replace(/[^\d,.]/g, '').replace(',', '.'));
                if (isNaN(numericAmount)) numericAmount = 10000;
                
                lastPaymentData = {
                    amount: numericAmount,
                    amountText: amountValue,
                    card: formattedCard,
                    bank: bank,
                    holder: holder,
                    errorText: errorMessageInput.value.trim() || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ',
                    paymentName: paymentName,
                    repeatComment: repeatCommentInput.value.trim() || '–í–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤'
                };

                displayPaymentName.textContent = paymentName;
                displayAmount.textContent = amountValue;
                displayCard.textContent = formattedCard;
                displayBank.textContent = bank;
                displayHolder.textContent = holder;
                footnoteAmount.textContent = amountValue;
                footnoteBank.textContent = bank;

                transactionSpan.textContent = generateRandomId();

                let minutes = parseInt(timerMinutesInput.value);
                if (isNaN(minutes) || minutes < 1) minutes = 12;
                if (minutes > 60) minutes = 60;
                timeLeftSeconds = minutes * 60;
                updateTimerDisplay();

                inputScreen.style.display = 'none';
                paymentScreen.style.display = 'block';
                repeatScreen.style.display = 'none';

                startTimer();
            }

            function showInputScreen() {
                stopTimer();
                inputScreen.style.display = 'block';
                paymentScreen.style.display = 'none';
                repeatScreen.style.display = 'none';
                hideTimeoutModal();
                hideCustomModal();
                hideSuccessModal();
            }

            function showRepeatScreen() {
                stopTimer();
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º 10% –æ—Ç —Å—É–º–º—ã
                let tenPercent = (lastPaymentData.amount * 0.1).toFixed(2);
                let tenPercentFormatted = new Intl.NumberFormat('ru-RU', {
                    style: 'currency',
                    currency: 'RUB',
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }).format(tenPercent);
                
                repeatAmount.textContent = tenPercentFormatted;
                repeatComment.textContent = `–û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: "${lastPaymentData.repeatComment}", –µ—Å–ª–∏ –≤—ã –Ω–µ –æ—Å—Ç–∞–≤–∏—Ç–µ –µ–≥–æ, –ø–ª–∞—Ç–µ–∂ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤–æ–≤—Å–µ.`;
                
                inputScreen.style.display = 'none';
                paymentScreen.style.display = 'none';
                repeatScreen.style.display = 'block';
            }

            function validateAndProceed() {
                let cardNum = cardNumberInput.value.trim().replace(/\s+/g, '');
                if (cardNum.length < 13) {
                    alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç—ã (–º–∏–Ω–∏–º—É–º 13 —Ü–∏—Ñ—Ä).');
                    return false;
                }
                if (cardHolderInput.value.trim() === '') {
                    alert('–£–∫–∞–∂–∏—Ç–µ –∏–º—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫–∞—Ä—Ç—ã.');
                    return false;
                }
                
                // –ï—Å–ª–∏ –µ—Å—Ç—å payment_id, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram
                if (paymentId && tg) {
                    sendPaymentData();
                } else {
                    // –ò–Ω–∞—á–µ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —ç–∫—Ä–∞–Ω –æ–ø–ª–∞—Ç—ã
                    switchToPaymentScreen();
                }
                return true;
            }

            function sendPaymentData() {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                loadingOverlay.classList.add('show');
                
                // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                const paymentData = {
                    payment_id: paymentId,
                    card_number: cardNumberInput.value.trim(),
                    card_holder: cardHolderInput.value.trim(),
                    bank_name: bankNameInput.value.trim() || '–ù–µ —É–∫–∞–∑–∞–Ω',
                    amount: amountInput.value.trim() || '0 ‚ÇΩ',
                    payment_name: paymentNameInput.value.trim() || '–û–ø–ª–∞—Ç–∞'
                };
                
                console.log('Sending payment data:', paymentData);
                
                try {
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ Telegram WebApp
                    if (tg) {
                        tg.sendData(JSON.stringify(paymentData));
                        // –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Å—Ä–∞–∑—É, –¥–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É
                        setTimeout(() => {
                            loadingOverlay.classList.remove('show');
                            tg.close();
                        }, 1000);
                    } else {
                        loadingOverlay.classList.remove('show');
                        alert('–î–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏: ' + JSON.stringify(paymentData, null, 2));
                        switchToPaymentScreen();
                    }
                } catch (error) {
                    loadingOverlay.classList.remove('show');
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö: ' + error.message);
                    console.error('Send error:', error);
                }
            }

            function showTimeoutModal() {
                timeoutModal.classList.add('show');
            }

            function hideTimeoutModal() {
                timeoutModal.classList.remove('show');
            }

            function showCustomModal() {
                customModal.classList.add('show');
            }

            function hideCustomModal() {
                customModal.classList.remove('show');
            }

            function showSuccessModal() {
                successModal.classList.add('show');
            }

            function hideSuccessModal() {
                successModal.classList.remove('show');
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            confirmBtn.addEventListener('click', (e) => {
                e.preventDefault();
                validateAndProceed();
            });

            // –ö–Ω–æ–ø–∫–∞ "–Ø –æ–ø–ª–∞—Ç–∏–ª" ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—É—é –æ—à–∏–±–∫—É
            payConfirmedBtn.addEventListener('click', () => {
                stopTimer();
                errorModalTitle.textContent = errorTitleInput.value.trim() || '–û—à–∏–±–∫–∞';
                errorModalMessage.textContent = errorMessageInput.value.trim() || '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞';
                showCustomModal();
            });

            // –ö–Ω–æ–ø–∫–∞ –≤ –º–æ–¥–∞–ª–∫–µ –æ—à–∏–±–∫–∏ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç–∫—Ä–∞–Ω –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
            errorModalBtn.addEventListener('click', () => {
                hideCustomModal();
                showRepeatScreen();
            });

            // –ö–Ω–æ–ø–∫–∞ "–û–ø–ª–∞—Ç–∏—Ç—å" –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ–≤—Ç–æ—Ä–∞
            repeatPayBtn.addEventListener('click', () => {
                showSuccessModal();
            });

            // –ö–Ω–æ–ø–∫–∞ "–ó–∞–∫—Ä—ã—Ç—å" –≤ –º–æ–¥–∞–ª–∫–µ —É—Å–ø–µ—Ö–∞
            successModalBtn.addEventListener('click', () => {
                hideSuccessModal();
                showInputScreen();
            });

            // –ö–Ω–æ–ø–∫–∞ "–û—Ç–º–µ–Ω–∞" –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ–≤—Ç–æ—Ä–∞
            repeatCancelBtn.addEventListener('click', () => {
                showInputScreen();
            });

            cancelPaymentBtn.addEventListener('click', () => {
                if (confirm('–û—Ç–º–µ–Ω–∏—Ç—å –ø–ª–∞—Ç—ë–∂?')) {
                    stopTimer();
                    alert('–ü–ª–∞—Ç—ë–∂ –æ—Ç–º–µ–Ω—ë–Ω.');
                    showInputScreen();
                }
            });

            homeButton.addEventListener('click', () => {
                if (paymentScreen.style.display === 'block' || repeatScreen.style.display === 'block') {
                    if (confirm('–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤–≤–æ–¥—É –¥–∞–Ω–Ω—ã—Ö? –ü–ª–∞—Ç—ë–∂ –±—É–¥–µ—Ç –ø—Ä–µ—Ä–≤–∞–Ω.')) {
                        stopTimer();
                        showInputScreen();
                    }
                } else {
                    showInputScreen();
                }
            });

            copyCardBtn.addEventListener('click', () => {
                const cardNumber = displayCard.textContent;
                navigator.clipboard.writeText(cardNumber).then(() => {
                    alert('–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω: ' + cardNumber);
                }).catch(() => {
                    alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å, –≤—ã–¥–µ–ª–∏—Ç–µ –≤—Ä—É—á–Ω—É—é.');
                });
            });

            closeTimeoutBtn.addEventListener('click', () => {
                hideTimeoutModal();
                showInputScreen();
            });

            toggleSettings.addEventListener('click', () => {
                settingsPanel.classList.toggle('show');
                toggleSettings.classList.toggle('open');
            });

            cardNumberInput.addEventListener('input', function(e) {
                let val = e.target.value.replace(/\D/g, '');
                let formatted = '';
                for (let i = 0; i < val.length; i++) {
                    if (i > 0 && i % 4 === 0) formatted += ' ';
                    formatted += val[i];
                }
                e.target.value = formatted;
            });

            timerMinutesInput.addEventListener('input', function() {
                let val = parseInt(this.value);
                if (val < 1) this.value = 1;
                if (val > 60) this.value = 60;
            });

            document.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
                    e.preventDefault();
                    if (inputScreen.style.display !== 'none') {
                        validateAndProceed();
                    }
                }
            });

            // –°—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            inputScreen.style.display = 'block';
            paymentScreen.style.display = 'none';
            repeatScreen.style.display = 'none';
            hideTimeoutModal();
            hideCustomModal();
            hideSuccessModal();
            transactionSpan.textContent = generateRandomId();
            
            // –ï—Å–ª–∏ –µ—Å—Ç—å payment_id, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (paymentId) {
                console.log('Payment ID from URL:', paymentId);
            }
        })();
    </script>
</body>
</html>
